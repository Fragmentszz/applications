(function(){"use strict";self.importScripts("spark-md5.min.js");function o(r,e){return new Promise((t,n)=>{let a=[],s=0;for(;s<r.size;)a.push({chunkFile:r.slice(s,s+e)}),s+=e;t(a)})}function c(){return Math.floor(Math.random()*1e9)}async function l(r){new self.SparkMD5.ArrayBuffer;try{const e=c();self.postMessage({percentage:100,fileHash:e,fileChunkList:r}),self.close()}catch(e){self.postMessage({name:"error",data:e}),self.close()}}self.addEventListener("message",async r=>{try{const{file:e,chunkSize:t}=r.data,n=await o(e,t);await l(n)}catch(e){console.error("worker监听发生错误:",e)}},!1),self.addEventListener("error",function(r){console.log("Worker触发主线程的error事件：",r),self.close()})})();
